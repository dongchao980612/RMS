# 接口篇

## 1 查询文章列表

在"routes"目录下新建"admin/article.js"文件，编写如下代码：

```javascript
const express = require('express');
const router = express.Router();

/* GET home page. */
router.get('/', function (req, res, next) {
    res.json({ message: '这里是后台文章的接口' });
});

module.exports = router;
```

修改app.js文件，引入刚才创建的路由文件：

```javascript
//后台路由文件
const adminArticlesRouter = require('./routes/admin/articles');

//后台路由配置
app.use('/admin/articles', adminArticlesRouter);
```

### 1. 配置路由

```js
const { Article } = require('../../models');
```

### 2. 查询数据库

```js
const articles = await Article.findAll(condition);

res.json({
    code: true,
    data: articles,
    message: '文章列表获取成功'
});
```

### 3. 数据排序

```js
const condition = {
    order: [['id', 'DESC']]
};

const articles = await Article.findAll(condition);
```

### 4. 异常处理

```js
try {
    const condition = {
        order: [['id', 'DESC']]
    };

    const articles = await Article.findAll(condition);

    res.json({
        code: true,
        data: articles,
        message: '文章列表获取成功'
    });
} catch (error) {
    res.status(500).json({
        code: false,
        data: [],
        message: '文章列表获取失败',
        errors: [error.message]
    });
}
```

## 2 查询文章详情

### 1. 在路由中添加id参数

```js
router.get('/:id', async function (req, res, next) {

});

 ```

### 2. 如何查询查文章详情

```js
const article = await Article.findByPk(id)

res.json({
code: true,
data: article,
message: '文章详情获取成功'
});

```

#### 3. 查询不存在的数据怎么办

```js
if (!article) {
    return res.status(404).json({
        code: false,
        message: '文章不存在'
    });
}
```
